$(document).ready(function(){$(".add_filter_button").live("click",function(){var b=!0,a=[],e=[],d=null,g=null;$(this).closest(".add_filter_div").children().each(function(){if($(this).hasClass("add_filter")&&""!==$(this).children("input[type=text]")[0].value)b=$(this).find("div > input[type=checkbox]")[0].checked,a.push($(this).children("input[type='text']")[0].value);else if($(this).hasClass("and_filter")&&""!==$(this).children("input")[0].value)a.push($(this).children("input")[0].value);else if($(this).hasClass("not_filter")&&
""!==$(this).children("input")[0].value)e.push($(this).children("input")[0].value);else if($(this).hasClass("size_filter")){var c=$(this).children("input")[0].value,h=$(this).children("select")[1].value,f=$(this).children("input")[1].value,k=$(this).children("select")[2].value;if(""!=c||""!=f)d?(alert("More than one size limit has been specified, remove the second and try again"),g=!0):(""==c&&(c=0),""==f&&(f=0),d=[c*h,f*k])}});if(g)return!1;var d=d?d.join("||||||"):"",a=0==a.length?"":a.join("||||||"),
e=0==e.length?"":e.join("||||||"),c=$(this).closest(".remote_setting").attr("id").split("remote_settings_")[1];if(""!=a||""!=e||""!=d)c="request=add_filter&name="+c+("&regex="+b),c+="&positive="+encodeURIComponent(a),c+="&negative="+encodeURIComponent(e),c+="&sizelim="+encodeURIComponent(d),socket.send(c)});$(".filter_group").live("click",function(){var b=$(this).closest(".remote_setting").attr("id").split("remote_settings_")[1],a=$(".filter_group",$(this).parent()).index($(this));confirm("Are you sure you want to remove this filter?")&&
socket.send("request=remove_filter&name="+b+"&index="+a)});$("#dialog_form").dialog({autoOpen:!1,height:300,width:350,modal:!0,buttons:{Submit:function(){var b=$("#password").val(),b=hashPassword(b);args.auth=b;var a=[];$.each(args,function(b,d){a.push(b+"="+encodeURIComponent(d))});b=a.join("&");socket.send(b);$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}},close:function(){$("#password").val("");args=null}});$(".remote_row").live("click",function(b){b=$(this).next();b.hasClass("is_hidden")?
b.removeClass("is_hidden"):b.addClass("is_hidden")});$("input").live("keydown",function(b){$(this).prev().css({color:"","font-weight":"","font-style":""})});$(".submit_button").live("click",function(b){b=$("input",$(this).parent().parent());args={tocrypt:[]};var a=!1;b.each(function(b){b=$(this).attr("name");var d=$(this).attr("value");d?args[b]=d:($(this).prev().css({color:"red","font-weight":"bold","font-style":"italic"}),a=!0)});if(a)return!1;args.request="set_source";args.name=$(this).attr("id").split("submit_")[1];
$("#dialog_form").dialog("open")})});function runSocketInit(){socket.send("request=get_sources")}function runSocketPostInit(){$(".bot_button").live("click",function(){if(!$(this).is(":disabled")){if(-1!==$(this).attr("id").indexOf("start_")){var b=$(this).attr("id").split("start_")[1];socket.send("request=start_bot&arguments="+b)}else b=$(this).attr("id").split("stop_")[1],socket.send("request=stop_bot&arguments="+b);$(this).attr("disabled",!0).find("img").attr("src","images/loading.gif")}})}
function onOpen(b){console.log("autoSocket opened",b,socket);runSocketInit()}
function onMessage(b){if("pong"!=b.data)if(0===b.data.indexOf("ERROR"))console.log(b.data),socket.close();else{var a=JSON.parse(b.data);if("get_sources"==a.request){if(a.error)return console.log("ERROR in request "+a.request+": "+a.error),!1;$("div#available").remove();b=$("table#available > tbody");for(i=0;i<a.response.length;i++)b.append($(a.response[i]));runSocketPostInit()}else if("get_source_single"==a.request){if(a.error)return console.log("ERROR in request "+a.request+": "+a.error),!1;refresh_drop_down_respond(a.response)}else if("add_filter"==
a.request){if(a.error)return console.log("ERROR in request "+a.request+": "+a.error),!1;refresh_drop_down(a.name)}else if("start_bot"==a.request){if(a.error)return console.log("ERROR in request "+a.request+": "+a.error),refresh_drop_down(a.name),!1;setTimeout(function(){refresh_drop_down(a.name)},2E3)}else if("stop_bot"==a.request)a.error&&console.log("ERROR in request "+a.request+": "+a.error),refresh_drop_down(a.name);else if("remove_filter"==a.request){if(a.error)return console.log("ERROR in request "+
a.request+": "+a.error),!1;refresh_drop_down(a.name)}else if("set_source"==a.request){if(a.error)return console.log("ERROR in request "+a.request+": "+a.error),!1;refresh_drop_down(a.name)}else console.log("socket message:",b.data)}}function refresh_drop_down(b){socket.send("request=get_source_single&arguments="+b)}
function refresh_drop_down_respond(b){b=$($(b)[2]);var a=b.attr("id").split("remote_settings_")[1];0==$(".bot_button",b).attr("id").indexOf("start_")?$(".status-"+a).html("off").removeClass("status-on").addClass("status-off"):$(".status-"+a).html("on").removeClass("status-off").addClass("status-on");$("#remote_settings_"+a).html(b.html())};
