var tabView=null;$(document).ready(function(){$("#tab_main").bind("click",function(){window.location="/?view=main";});if(window.location.hash)showoptions(window.location.hash.substring(1).split("show-")[1]);else showoptions("pyrt");$("ol.sidebar-list > li").bind("click",function(a){nam=a.target.id.split("-tab")[0];showoptions(nam);});$("input").bind("keyup",function(a){if(a.target.id=="pyrt-newpass"||a.target.id=="pyrt-newpassconf"){}else if(a.target.id=="pyrt-oldpass"){}else if(a.target.value==""){$(a.target).removeClass("badinput goodinput warninginput");$("#"+a.target.id+"error").html("");}else verify(a.target.id,a.target.value);}).bind("change",function(a){if(a.target.id=="general-movecheck"){$(a.target).addClass("goodinput");if(a.target.checked==true)$(".general-moveto").show();else $(".general-moveto").hide();}else if(a.target.id=="general-stopcheck")if(a.target.checked==true)$("#general-stopat-parent").removeClass("hidden");else $("#general-stopat-parent").addClass("hidden");else if(a.target.value=="")$(a.target).removeClass("badinput goodinput warninginput");});$(".submit-box").bind("click",function(a){elems=$("."+a.target.id.split("-")[0]+"-config.goodinput");keys=new Array();values=new Array();for(i=0;i<elems.length;i++){keys.push(elems[i].id);if(elems[i].id=="general-movecheck")values.push(encodeURIComponent(elems[i].checked));else values.push(encodeURIComponent(elems[i].value));}if(keys.length>0)$.ajax({url:"/ajax?request=set_config_multiple&keys="+keys+"&values="+encodeURIComponent(values),success:function(a){refresh_page();}});else alert("Nothing to submit!");});});function dragstart(a){a.dataTransfer.effectAllowed="move";a.dataTransfer.setData("Text",$(a.target).html());$("#tracker-info").html("Drag here to create a new group");}function dragover(a){a.preventDefault();}function drop(a){a.preventDefault();a.dataTransfer.dropEffect="move";var b=$(a.target).closest(".tracker-div");var c=a.dataTransfer.getData("Text");$.ajax({url:"/ajax?request=move_tracker&url="+c+"&target_alias="+b.attr("id").split("tracker-")[1],success:function(a){if(a=="OK")refresh_page();else console.log(a);}});}function dragend(a){$("#tracker-info").html("Drag to group icons");}function dragoverInfo(a){a.preventDefault();$(a.target).css({"color":"orange","font-weight":"bold"});}function dragleaveInfo(a){a.preventDefault();$(a.target).css({"color":"","font-weight":""});}function dropInfo(a){a.preventDefault();a.dataTransfer.dropEffect="move";console.log("Dropped into info box");$(a.target).css({"color":"","font-weight":""});var b=a.dataTransfer.getData("Text");$.ajax({url:"/ajax?request=move_tracker&url="+b+"&target_alias="+null,success:function(a){if(a=="OK")refresh_page();else console.log(a);}});}function showoptions(a){$(".selected").each(function(){if(this.id!=="tab_options")$(this).removeClass("selected");});var b=["pyrt","general","throttle","network","performance","trackers"];if(b.indexOf(a)==-1)a="pyrt";tabView=a;$("#"+a+"-tab").addClass("selected");$("#"+a).parent().addClass("selected");}function verify(a,b){$.ajax({url:"/ajax?request=verify_conf_value&key="+a+"&value="+encodeURIComponent(b),success:function(b){verif=b.substr(0,8);respo=b.substr(9,2);msg=b.substr(12);console.log(b);if(verif==="RESPONSE"&&respo=="OK"){$("#"+a).removeClass("badinput warninginput").addClass("goodinput");$("#"+a+"error").html("");}else if(verif==="RESPONSE"&&respo=="NO"){console.log($("#"+a));$("#"+a).removeClass("goodinput warninginput").addClass("badinput");$("#"+a+"error").html(msg);}else{$("#"+a).removeClass("goodinput badinput").addClass("warninginput");$("#"+a+"error").html("Unexpected response: "+b);}}});return false;}function refresh_page(){window.location.hash="show-"+tabView;window.location.reload(window.location);}